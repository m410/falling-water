<h1 class="text-accent1 display-4 mb-4">My Account</h1>

@if (loading()) {
  <div class="d-flex justify-content-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>
}

@if (error()) {
  <div class="alert alert-danger" role="alert">
    {{ error() }}
  </div>
}

@if (!loading() && user()) {
  <div class="row">
    <div class="col-lg-4 mb-4">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">
            <i class="bi bi-person-circle me-2"></i>Profile Information
          </h5>
        </div>
        <div class="card-body">
          <dl class="row mb-0">
            <dt class="col-sm-4">Name</dt>
            <dd class="col-sm-8">{{ user()!.name }}</dd>

            <dt class="col-sm-4">Username</dt>
            <dd class="col-sm-8">{{ user()!.username }}</dd>

            <dt class="col-sm-4">Email</dt>
            <dd class="col-sm-8">{{ user()!.email }}</dd>

            <dt class="col-sm-4">Phone</dt>
            <dd class="col-sm-8">{{ user()!.phone }}</dd>

            <dt class="col-sm-4">Member Since</dt>
            <dd class="col-sm-8">{{ user()!.created_at | date:'mediumDate' }}</dd>
          </dl>
        </div>
      </div>
    </div>

    <div class="col-lg-8">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">
            <i class="bi bi-bag-check me-2"></i>Purchase History
          </h5>
        </div>
        <div class="card-body">
          @if (orders().length === 0) {
            <div class="text-center py-4 text-muted">
              <i class="bi bi-bag-x display-4 d-block mb-3"></i>
              <p class="mb-2">No orders yet</p>
              <a [routerLink]="['/store']" class="btn btn-primary">Browse Store</a>
            </div>
          } @else {
            <div class="table-responsive">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>Order #</th>
                    <th>Date</th>
                    <th>Status</th>
                    <th class="text-end">Total</th>
                  </tr>
                </thead>
                <tbody>
                  @for (order of orders(); track order.id) {
                    <tr>
                      <td>
                        <strong>#{{ order.id }}</strong>
                      </td>
                      <td>{{ order.created_at | date:'mediumDate' }}</td>
                      <td>
                        <span class="badge" [class]="getStatusBadgeClass(order.status)">
                          {{ order.status }}
                        </span>
                      </td>
                      <td class="text-end">{{ order.total_amount | currency }}</td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          }
        </div>
      </div>
    </div>
  </div>
}
